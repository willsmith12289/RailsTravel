var rowCount = $('#markers').length;
if (rowCount >= 1) {
  $('#markers').html("<%=escape_javascript render(@markers)%>");
  createMarkers;
}
function createMarkers() {
  var lat_lng_array = gon.lat_lng_array;
  var infos = gon.info;
  for (var i = 0; i < lat_lng_array.length; i++) {
    var lat_lng = new google.maps.LatLng(lat_lng_array[i][0], lat_lng_array[i][1]);
    var info = infos[i];
    addMarker(lat_lngs, info);
  };
}

function addMarker(coord, info) {
  var marker = new google.maps.Marker({
    map: map,
    position: coord,
  });
  marker.setMap(map);
  var content = "<p>" + info + "</p>";
  marker.infowindow = new google.maps.InfoWindow({
    content: content
  });
  var prevInfo = false;
  google.maps.event.addListener(marker, 'click', function() {
    if (prevInfo) {
      prevInfo.close();
    } else {
      prevInfo = marker.infowindow;
      this.infowindow.open(map, this);
      this.setAnimation(google.maps.Animation.BOUNCE);
      setTimeout(function() {
        marker.setAnimation(null);
      }, 2150)
    }
  });
}